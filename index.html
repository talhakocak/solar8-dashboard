<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Solar8 Dashboard V10</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        * { box-sizing: border-box; }
        body {
            margin: 0; padding: 25px;
            height: 100vh; width: 100vw; overflow: hidden;
            font-family: 'Inter', sans-serif;
            background: linear-gradient(90deg, #030015 0%, #21174B 100%);
            color: white;
            display: flex; gap: 25px;
        }

        .sidebar { width: 28%; display: flex; flex-direction: column; gap: 20px; }

        .map-wrapper {
            flex: 60; position: relative; border-radius: 24px; overflow: hidden;
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        #map { width: 100%; height: 100%; }

        .weather-overlay {
            position: absolute; top: 15px; right: 15px; z-index: 1000;
            display: flex; gap: 8px;
        }
        .w-box {
            background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.15); border-radius: 10px;
            width: 60px; height: 70px; display: flex; flex-direction: column;
            align-items: center; justify-content: center; color: white;
        }
        .wb-day { font-size: 10px; opacity: 0.8; font-weight: 700; margin-bottom: 4px; text-transform: uppercase;}
        .wb-icon { font-size: 18px; color: #FFC700; margin-bottom: 4px; }
        .wb-temp { font-size: 14px; font-weight: 800; }

        .panels-card {
            flex: 40; background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 24px; padding: 20px;
            display: flex; flex-direction: column; overflow: hidden;
        }
        .panels-header {
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px; margin-bottom: 10px;
        }
        .ph-title { font-size: 13px; font-weight: 700; opacity: 0.8; text-transform: uppercase; letter-spacing: 0.5px;}
        .ph-badge { font-size: 10px; background: rgba(80, 205, 137, 0.2); color: #50CD89; padding: 3px 8px; border-radius: 4px; font-weight: 700; }

        .panel-list { display: flex; flex-direction: column; gap: 8px; overflow-y: auto; height: 100%; }
        .panel-list::-webkit-scrollbar { width: 4px; }
        .panel-list::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 2px; }
        
        .p-row {
            display: flex; justify-content: space-between; align-items: center;
            background: rgba(255,255,255,0.03); padding: 10px 12px; border-radius: 8px;
        }
        .p-info { display: flex; align-items: center; gap: 10px; }
        .p-icon { color: #00D2FF; font-size: 12px; opacity: 0.7; }
        .p-name { font-size: 13px; font-weight: 500; opacity: 0.9; }
        .p-score { font-size: 14px; font-weight: 700; color: #50CD89; font-family: 'Courier New', monospace; }
        .main-content { width: 72%; display: flex; flex-direction: column; }
        .header { display: flex; justify-content: space-between; margin-bottom: 20px; flex: 0 0 auto; }
        .header h1 { margin: 0; font-size: 26px; font-weight: 800; }
        .header p { margin: 0; opacity: 0.7; font-size: 13px; }
        .logo { font-size: 24px; font-weight: 900; }

        .grid { flex: 1; display: grid; grid-template-columns: repeat(3, 1fr); grid-template-rows: repeat(2, 1fr); gap: 25px; }

        .card {
            background: rgba(255, 255, 255, 0.06); backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 20px;
            padding: 20px; display: flex; flex-direction: column; justify-content: space-between;
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }
        .card-head { display: flex; justify-content: space-between; align-items: center; }
        .label-grp { display: flex; align-items: center; gap: 10px; }
        .c-icon { font-size: 20px; }
        .c-lbl { font-size: 14px; font-weight: 600; opacity: 0.8; text-transform: uppercase; }
        .badge { padding: 5px 10px; border-radius: 6px; font-size: 11px; font-weight: 700; background: rgba(255,255,255,0.1); }
        .badge.green { color: #50CD89; background: rgba(80, 205, 137, 0.15); }
        .badge.purple { color: #bf7cf7; background: rgba(191, 124, 247, 0.15); }
        
        .val { font-size: 42px; font-weight: 800; line-height: 1; margin-top: auto; margin-bottom: auto;}
        .unit { font-size: 20px; opacity: 0.5; margin-left: 5px; font-weight: 600; }
        
        .chart-wrap { width: 100%; height: 90px; margin-top: auto; }
        .accent-y { color: #FFC700; } 
        .accent-b { color: #009EF7; } 
        .accent-r { color: #F1416C; } 
        .accent-c { color: #00D2FF; }
        .accent-g { color: #50CD89; }

        .solar-pin {
            background: rgba(255, 199, 0, 0.9); border: 3px solid white; border-radius: 50%;
            box-shadow: 0 0 20px #FFC700; width: 20px; height: 20px; animation: pulse 2s infinite;
        }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(255, 199, 0, 0.7); } 100% { box-shadow: 0 0 0 0 rgba(0,0,0,0); } }
    </style>
</head>
<body>

    <div class="sidebar">
        <div class="map-wrapper">
            <div class="weather-overlay" id="weather-widget"><div class="w-box">...</div></div>
            <div id="map"></div>
        </div>

        <div class="panels-card">
            <div class="panels-header">
                <div class="ph-title">Dizi (String) Performansı</div>
                <div class="ph-badge">CANLI (3s)</div>
            </div>
            <div class="panel-list" id="panel-container"></div>
        </div>
    </div>

    <div class="main-content">
        <div class="header">
            <div><h1>Solar8 Saha İzleme</h1><p>Canlı Veri Akışı</p></div>
        </div>

        <div class="grid">
            <div class="card">
                <div class="card-head"><div class="label-grp"><i class="fa-solid fa-bolt c-icon accent-y"></i><div class="c-lbl">Anlık Güç</div></div><span class="badge green">Aktif</span></div>
                <div class="val"><span id="pVal">245.8</span><span class="unit">kW</span></div>
            </div>

            <div class="card">
                <div class="card-head">
                    <div class="label-grp">
                        <i class="fa-solid fa-sack-dollar c-icon accent-g"></i>
                        <div class="c-lbl">Bugünkü Kazanç</div>
                    </div>
                </div>
                <div class="val"><span id="moneyVal">4.850,20</span><span class="unit">₺</span></div>
            </div>

            <div class="card">
                <div class="card-head"><div class="label-grp"><i class="fa-solid fa-chart-pie c-icon accent-b"></i><div class="c-lbl">Verimlilik</div></div><span class="badge purple">Yüksek</span></div>
                <div class="val" id="efVal">%91.4</div>
            </div>

            <div class="card">
                <div class="card-head"><div class="c-lbl">Işınım</div></div>
                <div class="val" style="font-size:32px;" id="irVal">850 W/m²</div>
                <div class="chart-wrap"><canvas id="cIr"></canvas></div>
            </div>
            <div class="card">
                <div class="card-head"><div class="c-lbl">Modül Isısı</div></div>
                <div class="val" style="font-size:32px;" id="mdVal">42.1 °C</div>
                <div class="chart-wrap"><canvas id="cMd"></canvas></div>
            </div>
            <div class="card">
                <div class="card-head"><div class="c-lbl">Nem</div></div>
                <div class="val" style="font-size:32px;" id="hmVal">%45</div>
                <div class="chart-wrap"><canvas id="cHm"></canvas></div>
            </div>
        </div>
    </div>

    <script>
        const map = L.map('map', {zoomControl: false, attributionControl: false}).setView([40.930, 29.324], 13);
        L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {maxZoom: 19}).addTo(map);
        const icon = L.divIcon({ className: 'solar-pin', iconSize: [20, 20] });
        L.marker([40.930, 29.324], { icon: icon }).addTo(map).bindPopup("<b>Solar8 Saha</b>").openPopup();

        async function getWeather() {
            try {
                const res = await fetch('https://api.open-meteo.com/v1/forecast?latitude=40.93&longitude=29.32&daily=weathercode,temperature_2m_max&timezone=auto&forecast_days=3');
                const data = await res.json();
                let html = ''; const days = ['PAZ','PZT','SAL','ÇAR','PER','CUM','CMT'];
                const getIcon = (c) => (c===0)?'<i class="fa-solid fa-sun wb-icon"></i>':(c<4)?'<i class="fa-solid fa-cloud-sun wb-icon"></i>':'<i class="fa-solid fa-cloud-rain wb-icon" style="color:#00D2FF"></i>';
                data.daily.time.forEach((d, i) => {
                    let day = (i===0)?'BUGÜN':days[new Date(d).getDay()];
                    html += `<div class="w-box"><span class="wb-day">${day}</span>${getIcon(data.daily.weathercode[i])}<span class="wb-temp">${Math.round(data.daily.temperature_2m_max[i])}°</span></div>`;
                });
                document.getElementById('weather-widget').innerHTML = html;
            } catch(e){}
        }
        getWeather();

        const panelContainer = document.getElementById('panel-container');
        let panels = [];
        for(let i=1; i<=7; i++) panels.push({ id: i, score: 88 + Math.random()*4 });

        function renderPanels() {
            let html = ''; let totalScore = 0;
            panels.forEach(p => {
                totalScore += p.score;
                let color = p.score > 90 ? '#50CD89' : '#FFC700';
                html += `
                <div class="p-row">
                    <div class="p-info">
                        <i class="fa-solid fa-solar-panel p-icon"></i>
                        <span class="p-name">Dizi #${String(p.id).padStart(2,'0')}</span>
                    </div>
                    <span class="p-score" style="color:${color}">%${p.score.toFixed(2)}</span>
                </div>`;
            });
            panelContainer.innerHTML = html;
            let avg = totalScore/panels.length;
            document.getElementById('efVal').innerText = "%" + avg.toFixed(1);
        }
        renderPanels();

        function chart(ctx, color, data) {
            let grad = ctx.createLinearGradient(0,0,0,90); 
            grad.addColorStop(0,color.replace('1)','0.5)')); grad.addColorStop(1,color.replace('1)','0)'));
            return new Chart(ctx, { type:'line', data:{labels:Array(20).fill(''),datasets:[{data:data,borderColor:color,backgroundColor:grad,borderWidth:2,tension:0.4,fill:true,pointRadius:0}]}, options:{responsive:true,maintainAspectRatio:false,animation:false,plugins:{legend:false},scales:{x:{display:false},y:{display:true,position:'right',type:'linear',ticks:{color:'rgba(255,255,255,0.5)',font:{size:10,family:'Inter'},maxTicksLimit:4,precision:0},grid:{color:'rgba(255,255,255,0.05)',drawBorder:false}}},layout:{padding:{left:-5,right:0,top:5,bottom:0}}} });
        }
        let dIr=Array(20).fill(850).map(()=>850+(Math.random()-0.5)*20), dMd=Array(20).fill(42).map(()=>42+(Math.random()-0.5)*2), dHm=Array(20).fill(45).map(()=>45+(Math.random()-0.5)*5);
        const c1=chart(document.getElementById('cIr').getContext('2d'),'rgba(255,199,0,1)',dIr), c2=chart(document.getElementById('cMd').getContext('2d'),'rgba(241,65,108,1)',dMd), c3=chart(document.getElementById('cHm').getContext('2d'),'rgba(0,210,255,1)',dHm);

        let p=245.8, money=4850.50, ir=850, md=42.1, hm=45;

        setInterval(()=>{
            let r=(Math.random()-0.5); p+=r*4; ir+=r*15; if(ir>1000)ir=990; if(ir<200)ir=210; md+=(25+(ir/30)-md)*0.1; hm+=r; 
            
            money += 0.25 + (Math.random() * 0.1); 

            panels.forEach(pan => {
                let change = (Math.random() - 0.5) * 0.2; pan.score += change;
                if(pan.score > 92.0) pan.score = 91.9; if(pan.score < 88.0) pan.score = 88.1;
            });
            renderPanels();

            document.getElementById('pVal').innerText=p.toFixed(1); 
            document.getElementById('moneyVal').innerText = money.toLocaleString('tr-TR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
            document.getElementById('irVal').innerText=ir.toFixed(0)+" W/m²"; 
            document.getElementById('mdVal').innerText=md.toFixed(1)+" °C"; 
            document.getElementById('hmVal').innerText="%"+hm.toFixed(0);
            function up(c,v){
                c.data.datasets[0].data.shift(); c.data.datasets[0].data.push(v);
                let minVal = Math.min(...c.data.datasets[0].data); let maxVal = Math.max(...c.data.datasets[0].data);
                c.options.scales.y.min = Math.floor(minVal / 5) * 5; c.options.scales.y.max = Math.ceil(maxVal / 5) * 5;
                c.update();
            } 
            up(c1,ir); up(c2,md); up(c3,hm);

        }, 3000);

    </script>
</body>

</html>


